#:kivy 1.10.0
#: import Difficulty difficulty.Difficulty
#: import PlayerMode playermode.PlayerMode
#: import Screen screens.screen.Screen
#: import PlayerSelect screens.playerselect.PlayerSelect
#: import DifficultySelect screens.difficultyselect.DifficultySelect
#: import Game screens.game.Game

# note: file name lacks underscores due to kivy's reliance on file naming convention

<TicTacToeScreenManager>:
    id: screen_manager

    screen_player_select: screen_player_select
    screen_difficulty_select: screen_difficulty_select
    screen_game:  screen_game

    PlayerSelect:
        id: screen_player_select
        name: Screen.PLAYER_SELECT.value
        manager: screen_manager

    DifficultySelect:
        id: screen_difficulty_select
        name: Screen.DIFFICULTY_SELECT.value
        manager: screen_manager

    Game:
        id: screen_game
        name: Screen.GAME.value
        manager: screen_manager

<PlayerSelect>:
    BoxLayout:
        size: self.parent.size  # important!
        pos: self.parent.pos  # important!
        orientation: 'vertical'
        padding: 200
        spacing: 20
        Button:
            text: "One Player"
            on_release: root.manager.screen_game.mode = PlayerMode.ONE
            on_release: root.manager.current = Screen.DIFFICULTY_SELECT.value
        Button:
            text: "Two Player"
            on_release: root.manager.screen_game.mode = PlayerMode.TWO
            on_release: root.manager.current = Screen.GAME.value

<DifficultySelect>:
    BoxLayout:
        size: self.parent.size  # important!
        pos: self.parent.pos  # important!
        orientation: 'vertical'
        padding: 200
        spacing: 20
        Button:
            text: "Easy"
            on_release: root.manager.screen_game.difficulty = Difficulty.EASY
            on_release: root.manager.current = Screen.GAME.value
        Button:
            text: "Normal"
            on_release: root.manager.screen_game.difficulty = Difficulty.NORMAL
            on_release: root.manager.current = Screen.GAME.value
        Button:
            text: "Hard"
            on_release: root.manager.screen_game.difficulty = Difficulty.HARD
            on_release: root.manager.current = Screen.GAME.value

<Game>:
    GridLayout:
        rows:3
        cols:3
        spacing:10
        padding:10
        size: root.width, root.height

        Button:
            font_size:100
            text: root.state[0]
            disabled: root.state[0] != ''
            on_press: root.select_cell(0, 0)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[1]
            disabled: root.state[1] != ''
            on_press: root.select_cell(0, 1)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[2]
            disabled: root.state[2] != ''
            on_press: root.select_cell(0, 2)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[3]
            disabled: root.state[3] != ''
            on_press: root.select_cell(1, 0)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[4]
            disabled: root.state[4] != ''
            on_press: root.select_cell(1, 1)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[5]
            disabled: root.state[5] != ''
            on_press: root.select_cell(1, 2)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[6]
            disabled: root.state[6] != ''
            on_press: root.select_cell(2, 0)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[7]
            disabled: root.state[7] != ''
            on_press: root.select_cell(2, 1)
            on_release: root.player_moved()

        Button:
            font_size:100
            text: root.state[8]
            disabled: root.state[8] != ''
            on_press: root.select_cell(2, 2)
            on_release: root.player_moved()
